[TOC]



# 一：层次结构

## 传输层

传输层主要是确保两台计算机之间通信的建立，维护，断开，并确保通信的可靠性。

###  **1：数据分割与重组 @**

传输层将来自应用层的数据分割成适当的报文段，在接收端，传输层负责将这些报文段重新组装为完整的消息。注意传输层向网络层递交**报文段**。

**举例：** 当你下载一个大文件时，传输层会将文件分割成小的数据段，**每个数据段独立传输，然后在目标主机上重新组装成完整的文件。**



### 2. **可靠性传输**

传输层确保数据的可靠传输。它使用各种技术，如**确认**（acknowledgment）、**重传**（retransmission）和**流量控制**（flow control），来确保数据在发送和接收之间的完整性和准确性。

**举例：** 在网页浏览中，如果你的计算机发送了一个请求（比如点击链接），传输层会确保这个请求被正确地传送到服务器，并且服务器接收到请求后会返回相应的网页数据，也经过传输层的可靠传输保证数据的完整性。



### 3. **多路复用与多路分解 @**

传输层允许多个应用程序同时使用网络。每个应用程序会被分配一个唯一的标识符（通常是端口号），传输层使用这些标识符将数据正确地传递给相应的应用程序。

**举例：** 当你的计算机同时运行着网页浏览器、下载软件和在线游戏时，传输层会确保从网络上接收到的数据包正确地交付到相应的应用程序，以保证各个应用程序之间的数据不混淆。



### 4. **流量控制**

传输层通过流量控制机制，防止发送方发送速度过快，超过接收方的处理能力，从而避免网络拥塞和数据丢失。

**举例：** 在视频流播放时，传输层会根据接收端的处理速度来控制视频数据的发送速度，确保视频连续播放而不出现卡顿。



### 5. **拥塞控制**

传输层也负责监控网络的拥塞程度，并采取相应措施来避免拥塞。这可以通过**减小发送速度、重新选择路径**等方式来实现。

**举例：** 当某个网络路段出现拥塞时，传输层可以减缓数据的发送速度，以降低对该路段的压力，避免数据包丢失或延迟。





## 网络层

网络层的主要作用是实现**不同网络之间的数据传输**，它负责将数据从源主机传送到目标主机，无论这两台主机是否在同一个局域网内，甚至是位于全球范围内的不同网络中。



### 1. **路径选择 @**

网络层负责选择数据包从源主机到目标主机的路径。在互联网中，数据可能需要经过多个路由器、交换机等网络设备，网络层决定了数据包在这些设备之间的传递路径。这就好比规划一条从出发地到目的地的路线。

**举例：** 当你在浏览器中输入一个网址，网络层决定了你的请求数据包是通过哪些路由器、交换机等设备传输，最终到达服务器。



### 2. **逻辑寻址 @**

每台连接到网络的设备都有一个唯一的网络层地址，通常是IP地址。网络层使用这些地址来标识不同的设备，确保数据包能够被正确地发送到目标设备。

**举例：** IP地址就像是网络中的“门牌号”，它保证了数据包能够准确地被送达到目标设备，就像信件通过邮政系统被送到正确的地址一样。



### 3. **分组和转发**

网络层将数据分割成小的数据包（通常称为数据报），这些数据包独立地传输，并且可以通过不同的路径到达目标。网络层的设备，比如路由器，负责根据目标地址将数据包转发到下一个网络节点。

**举例：** 当你下载一个大文件时，文件会被分割成许多小的数据包，这些数据包可以通过不同的路由器和链路独立传输，然后在目标主机重新组装成完整的文件。



### 4. **错误处理和流量控制**

网络层负责在数据传输过程中处理可能出现的错误，确保数据的可靠性。它还涉及到流量控制，即控制数据包的发送速度，以避免网络拥塞。

**举例：** 在视频通话中，网络层可以检测到数据包的丢失，并尝试重新发送这些丢失的数据包，以保证视频通话的质量。



## 数据链路层

数据链路层的主要作用是在直接相连的两台设备之间提供可靠的数据传输，并且负责控制对物理介质的访问。它实现了点到点和点到多点之间的数据传输，确保数据在相邻设备之间的可靠传输。



### 1. **封装成帧 @**

数据链路层将来自网络层的数据报封装成数据帧（Frame），每个帧包含了数据以及控制信息，如起始标志和终止标志，用于标识帧的开始和结束。



### 2. **透明传输  @**

数据链路层负责将数据可靠地传输到相邻的设备，无论这两个设备之间的物理连接是什么类型，比如以太网、Wi-Fi等。

**举例：** 你使用无线网络连接手机和路由器之间的通信，数据链路层确保了数据能够透明地在这个无线连接上传输。



### 3. **差错检测和纠正**

数据链路层使用校验和等技术检测帧在传输过程中是否发生了错误，并且在可能的情况下进行错误的纠正。

**举例：** 如果你通过Wi-Fi下载文件，数据链路层可以检测到如果某个数据帧在传输过程中受到了干扰，然后尝试进行错误的纠正，确保接收到的数据是正确的。



### 4. **流量控制**

数据链路层确保发送方和接收方的数据传输速度匹配，防止接收方被发送方淹没，导致数据丢失。

**举例：** 在以太网中，数据链路层使用一种叫做“停等协议”（Stop-and-Wait Protocol），确保在发送数据帧后，等待接收到对方的确认帧，以维持传输的平衡。



### 5. **地址解析  @**

数据链路层使用**硬件地址（MAC地址）将数据帧正确地传递到目标设备**，确保数据帧被正确地发送到相应的网络接口。

**举例：** 当你的计算机通过以太网连接到路由器时，数据链路层使用MAC地址确保数据帧被准确地送达到你的计算机，而不是网络上的其他设备。



# 二：封装



应用层将报文下发给传输层，传输层对应用层下发的报文进行分割并添加上首部信息（**源端口号，目标端口号，差错检测位信息，* 。。。。。。），因此传输层的报文段封装了应用层的报文。

> 在传输层，数据被封装成段（Segment），每个段包含一个**源端口号**和一个**目标端口号**。这些端口号是16位的数字，用于**标识发送和接收应用程序的端口**。发送方将数据发送到目标端口号，接收方根据目标端口号将数据交给相应的应用程序。
>
> 举例：当你的计算机上同时运行着网页浏览器和邮件客户端时，网页浏览器可能使用的是端口号80，而邮件客户端可能使用的是端口号25。传输层使用这些端口号将数据传递到正确的应用程序。
>
> 
>
> 差错检测位信息，该信息让接收方判断报文中的比特是否在传输的过程中被该改变。

然后运输层将数据报下发给网络层，网络层对其添加上首部信息（源IP地址，目标IP地址），因此网络层封装了传输层的报文段。

> 1. **源IP地址（Source IP Address）：** 这是发送端计算机的唯一标识，用来告诉网络上的其他设备数据的来源。当数据到达目标设备时，目标设备知道这个数据是从哪里来的。
>
>    **举例：** 如果你在美国的计算机上向一个位于英国的服务器发送请求，你的计算机的IP地址就是源IP地址，告诉服务器请求是从哪个计算机发出的。
>
> 2. **目标IP地址（Destination IP Address）：** 这是接收端计算机的唯一标识，用来指示数据的目标地址。数据将被传送到这个IP地址所对应的设备。
>
>    **举例：** 当你在浏览器中输入一个网址，这个网址会被转换为对应的服务器IP地址。目标IP地址告诉网络，数据需要被送到这个IP地址所代表的服务器上。
>
>    
>
>    网络层的这些信息使得数据在网络中能够被正确路由到目标地址。就像寄信时需要正确的寄件人地址和收件人地址，网络层的IP地址信息确保了数据的准确传递，无论数据要跨越多少个路由器、交换机和其他网络设备。

网络层的数据报再下方到数据链路层，数据链路层再加上首部信息（源mac地址，目标mac地址）

> 1. **源MAC地址（Source MAC Address）：** 这是发送端设备的物理地址，也被称为网卡地址。每个网络设备，比如计算机、路由器，都有一个唯一的MAC地址。源MAC地址告诉网络中的其他设备数据的来源。
>
>    **举例：** 当你的计算机发送数据到**局域网**中的其他设备时，数据链路层会将该设备的MAC地址放入数据帧的首部，指示数据来自哪个具体的计算机。
>
> 2. **目标MAC地址（Destination MAC Address）：** 这是接收端设备的物理地址，也就是数据帧的目标。数据链路层使用目标MAC地址确保数据帧被准确地传递给正确的设备。
>
>    **举例：** 当你的计算机想要接收来自**局域网**中其他设备的数据时，数据链路层会根据目标设备的MAC地址将数据帧准确传递给那个设备，而不是局域网中的其他设备。
>
> 3. **IP地址与mac地址的区别**
>
>    ### 1. **MAC地址（物理地址）：**
>
>    - **作用：** MAC地址是网络设备（比如计算机、手机、路由器等）在局域网中的唯一标识，用于在局域网中识别设备。
>    - **特点：** MAC地址是由网络设备的制造商预先分配的，通常是一个48位的十六进制数字，表示设备的唯一身份。
>    - **局限性：** MAC地址只在设备所连接的局域网中是唯一的，不同的局域网可能有相同的MAC地址。
>    - **举例：** 假设你的计算机和手机连接到同一个Wi-Fi网络。它们在这个局域网中分别有独特的MAC地址，以确保路由器知道哪个设备发送了数据，也知道把数据送到哪个设备。
>
>    ### 2. **IP地址：**
>
>    - **作用：** IP地址是用于在网络中定位设备的数字地址，使数据能够在不同网络之间传递。
>    - **特点：** IP地址通常由网络管理员分配，可以根据网络的层级结构（例如，局域网、互联网）来唯一标识设备。
>    - **全球性：** IP地址在全球范围内保持唯一性，确保了设备可以在不同的网络之间进行通信。
>    - **举例：** 如果你的计算机需要访问一个网站，它会使用目标网站的IP地址（例如，`192.168.1.1`）来路由数据，确保数据从你的计算机到达正确的服务器，无论这两台设备位于世界上的哪个地方。
>
>    **总结：** MAC地址用于在局域网内唯一标识设备，而IP地址则在全球范围内唯一标识设备，帮助数据在不同网络之间进行传递。MAC地址是局域网中的“内部地址”，而IP地址则是在更大范围、跨越不同网络的“公共地址”。它们各自在不同层级的网络通信中发挥着关键作用。



























